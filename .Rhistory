RHermesGUI()
RHermesGUI()
library(RHermes)
install()
install()
runApp('inst/app')
runApp('inst/app')
install()
runApp('inst/app')
install()
runApp('inst/app')
library(RHermes)
runApp('inst/app')
whichMS2
whichMS2[1]
n
install()
runApp('inst/app')
source('~/RHermes/inst/app/Identifications_UI.R')
install()
runApp('inst/app')
install()
runApp('inst/app')
n
n
source('~/RHermes/inst/app/Identifications_UI.R')
install()
RHermesGUI()
install()
RHermesGUI()
c
runApp('inst/app')
install()
runApp('inst/app')
source('~/RHermes/inst/app/Identifications_UI.R')
install()
runApp('inst/app')
install()
runApp('inst/app')
n
source('~/RHermes/inst/app/Identifications_UI.R')
install()
runApp('inst/app')
install()
runApp('inst/app')
install()
runApp('inst/app')
install()
devtools::install()
RHermes::RHermesGUI()
?renderDataTable
devtools::install()
RHermes::RHermesGUI()
devtools::install()
RHermes::RHermesGUI()
devtools::install()
RHermes::RHermesGUI()
RHermes::RHermesGUI()
RHermes::RHermesGUI()
myHermes <- readRDS("D:/ABrunner/MS1_pos_Ident3.rds")
View(myHermes)
myHermes@data@MS2Exp[[4]]@IL@annotation[[392]]
myHermes@data@MS2Exp[[4]]@IL@annotation[[392]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[391]]$metadata
enviPat::isopattern(data(isotopes), "C9H16ClN5")
enviPat::isopattern(isotopes, "C9H16ClN5")
enviPat::isopattern(isotopes, "C9H17ClN5")
myHermes@data@MS2Exp[[4]]@IL@annotation[[392]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[391]]$metadata
enviPat::isopattern(isotopes, "C9H17ClN5")
myHermes@data@SOI[[6]]@SoiList
myHermes@data@SOI[[6]]@SoiList[1025,]
View(myHermes@data@SOI[[6]]@SoiList)
View((myHermes@data@SOI[[6]]@SoiList)[[12]][[1398]])
View((myHermes@data@SOI[[6]]@SoiList)[[12]][[1399]])
3.5*10E-6*232
View(myHermes)
myHermes <- readRDS("D:/ABrunner/MS1_pos_SOI.rds")
for(i in 1:6){
myHermes <- SOIcleaner(myHermes, soiid = i, minint = 10000, TRUE)
}
devtools::install()
for(i in 1:6){
myHermes <- SOIcleaner(myHermes, soiid = i, minint = 10000, TRUE)
}
View(myHermes)
View(myHermes@data@SOI[[6]]@SoiList)
myHermes <- genIL(myHermes, id = 3, par = ILParam(priorization = "full"))
myHermes <- genIL(myHermes, id = 3, par = ILParam(priorization = "yes", ad = c("M+H", "M+NH4", "M+CH3OH+H")))
myHermes <- genIL(myHermes, id = 6, par = ILParam(priorization = "full"))
myHermes <- genIL(myHermes, id = 6, par = ILParam(priorization = "yes", ad = c("M+H", "M+NH4", "M+CH3OH+H")))
saveRDS(myHermes, file = "D:/ABrunner/MS1_pos_SOI_filter2.rds")
ms2f <- list.files("D:/ABrunner/MSMSdata", pattern = ".*pos.*.mzML", full.names = TRUE)[seq(1,31)]
myHermes <- MS2Proc(myHermes, 1, MS2files = ms2f, referenceDB = "D:/MS2ID_20200824_202808.rds", useDB = TRUE)
myHermes <- MS2Proc(myHermes, 2, MS2files = ms2f, referenceDB = "D:/MS2ID_20200824_202808.rds", useDB = TRUE)
ms2f <- list.files("D:/ABrunner/MSMSdata", pattern = ".*pos.*.mzML", full.names = TRUE)[seq(33,45)]
myHermes <- MS2Proc(myHermes, 3, MS2files = ms2f, referenceDB = "D:/MS2ID_20200824_202808.rds", useDB = TRUE)
myHermes <- MS2Proc(myHermes, 4, MS2files = ms2f, referenceDB = "D:/MS2ID_20200824_202808.rds", useDB = TRUE)
saveRDS(myHermes, file = "D:/ABrunner/MS1_pos_Ident4.rds")
RHermesGUI()
RHermesGUI()
View(myHermes)
View(myHermes@data@MS2Exp[[4]]@IL@IL)
View(myHermes@data@MS2Exp[[4]]@IL@annotation[[40]])
View((myHermes@data@MS2Exp[[4]]@IL@annotation[[40]])[[5]][[3]])
View((myHermes@data@MS2Exp[[4]]@IL@annotation[[40]])[[5]][[2]])
View((myHermes@data@MS2Exp[[4]]@IL@annotation[[40]])[[5]][[1]])
View(myHermes@data@MS2Exp[[4]]@Ident[["MS2Features"]])
RHermesGUI()
View(myHermes@data@MS2Exp[[4]]@IL@annotation[[1]])
myHermes@data@MS2Exp[[4]]@IL@annotation[[91]]
myHermes@data@MS2Exp[[4]]@IL@annotation[[93]]
myHermes@data@MS2Exp[[4]]@IL@annotation[[93]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[91]]$metadata[[1]]
myHermes@data@MS2Exp[[4]]@IL@annotation[[91]]$metadata[[1]]
myHermes@data@MS2Exp[[4]]@IL@annotation[[91]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[93]]$metadata
isopattern(isotopes, "C9H10N3O2")
3.5e-6*192
View(myHermes)
View(myHermes@data@SOI[[6]]@SoiList)
View((myHermes@data@SOI[[6]]@SoiList)[[12]][[1266]])
193.07383-193.0799551
193.07383-193.0806564
isopattern(isotopes, "C9H10N3O2", charge = 1)
193.07383-193.0801079
View(myHermes)
View(myHermes@data@PL[[3]]@peaklist)
myHermes@data@PL[[3]]@peaklist[.("[C9H10N3O2]+")]
View(myHermes@data@PL[[3]]@peaklist[.("[C9H10N3O2]+")])
isopattern(isotopes, "[C9H10N3O2]+", charge = 1)
367.6736264/60
myHermes@data@MS2Exp[[4]]@IL@annotation[[103]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[102]]$metadata
isopattern(isotopes, "[C8H11N4O2]+")
isopattern(isotopes, "[C8H11N4O2]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[103]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[102]]$metadata
isopattern(isotopes, "[C8H11N4O2]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[94]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[95]]$metadata
isopattern(isotopes, "[C7H7N2S]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[107]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[111]]$metadata
isopattern(isotopes, "[C13H16N3O2]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[134]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[135]]$metadata
isopattern(isotopes, "[C7H6Cl2NO]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[140]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[142]]$metadata
isopattern(isotopes, "[C11H13N2O]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[146]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[147]]$metadata
isopattern(isotopes, "[C11H19N4O2]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[148]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[149]]$metadata
isopattern(isotopes, "[C9H8Cl2N5]+", charge = 1)
3.5e-6*257
3827186*0.097341554
myHermes@data@MS2Exp[[4]]@IL@annotation[[229]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[233]]$metadata
isopattern(isotopes, "[C6H5ClN3]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[236]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[240]]$metadata
isopattern(isotopes, "[C8H10N3]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[266]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[268]]$metadata
isopattern(isotopes, "[C9H12ClN2O]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[161]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[162]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[291]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[272]]$metadata
isopattern(isotopes, "[C8H7ClKN2]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[211]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[311]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[313]]$metadata
isopattern(isotopes, "[C25H29N6O]+", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[317]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[323]]$metadata
isopattern(isotopes, "[C10H14ClN2O]+", charge = 1)
isopattern(isotopes, "C10H14ClN2O", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[324]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[332]]$metadata
isopattern(isotopes, "C8H15ClN5", charge = 1)
myHermes@data@MS2Exp[[4]]@IL@annotation[[340]]$metadata
myHermes@data@MS2Exp[[4]]@IL@annotation[[346]]$metadata
isopattern(isotopes, "[C12H19N2O]+", charge = 1)
isopattern(isotopes, "[C12H19N2O]+", charge = 1, threshold = 1)
isopattern(isotopes, "[C12H19N2O]+", charge = 1, threshold = 0.01)
View(myHermes)
myHermes@metadata@ExpParam@isoList[[1]][["[C12H19N2O]+"]]
View(myHermes@metadata@ExpParam@isoList[[2]])
myHermes@metadata@ExpParam@isoList[[2]][myHermes@metadata@ExpParam@isoList[[1]][["[C12H19N2O]+"]]]
myHermes@metadata@ExpParam@isoList[[2]][myHermes@metadata@ExpParam@isoList[[1]][["[C12H19N2O]+"]],]
208.1462246 - 207.1491897
208.1525445 - 207.1491897
myHermes@metadata@ExpParam@isoList[[2]][myHermes@metadata@ExpParam@isoList[[1]][["[C8H11N4O2]+"]],]
myHermes@metadata@ExpParam@isoList[[2]][myHermes@metadata@ExpParam@isoList[[1]][["[C7H7N2S]+"]],]
myHermes@metadata@ExpParam@isoList[[2]][myHermes@metadata@ExpParam@isoList[[1]][["[C13H16N3O2]+"]],]
myHermes@metadata@ExpParam@isoList[[2]][myHermes@metadata@ExpParam@isoList[[1]][["[C9H5Cl2N5]+"]],]
myHermes@metadata@ExpParam@isoList[[2]][myHermes@metadata@ExpParam@isoList[[1]][["[C9H8Cl2N5]+"]],]
isopattern(isotopes, "C9H8Cl2N5", charge = 1)
isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 1)
1.5*3.5*257
1.5*3.5e-6*257
isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 0.1)
isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 0.01)
isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 0.02)
kTHR <- 1
resol_factor <- 120000/sqrt(200)
x <- isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 0.02)
x <- isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 0.02)[[1]]
limitfactor <- 2 * kTHR * x[1, 1]^(3/2)/resol_factor
limitfactor
myHermes@metadata@ExpParam@res
myHermes@metadata@ExpParam
sqrt(200)
2 * kTHR * x[1, 1]^(3/2)
x[1, 1]^(3/2)
x[1, 1]
x[1, 1]^(2)
x[1, 1]^(3/2)
farenough <- diff(x[, 1]) > limitfactor
good <- c()
for (i in seq_len(nrow(x))) {
if (i == nrow(x)) {
good <- c(good, i)
next
}
if (farenough[i]) {
good <- c(good, i)
} else {
if (x[i, 2] > x[i + 1, 2]) {
good <- c(good, i)
}
}
}
good <- unique(good)
x <- x[good, ]
View(x)
farenough <- diff(x[, 1]) > limitfactor
x <- isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 0.02)[[1]]
farenough <- diff(x[, 1]) > limitfactor
x[farenough]
x[farenough,]
limitfactor <- 2 * kTHR * x[1, 1]/resol_factor
limitfactor <- 2 * kTHR * x[1, 1]^(1/2)/resol_factor
limitfactor <- 2 * kTHR * x[1, 1]^(3/2)/resol_factor
limitfactor <- 2 * kTHR * x[1, 1]^(1/2)/resol_factor
farenough <- diff(x[, 1]) > limitfactor
x[farenough,]
isotopecode <- data.frame(name = c("13C", "17O", "18O", "2H",
"15N", "33S", "34S", "36S", "37Cl", "81Br", "41K", "6Li",
"10B", "21Ne", "22Ne", "25Mg", "26Mg", "29Si", "30Si",
"42Ca", "43Ca", "44Ca", "48Ca", "46Ti", "47Ti", "49Ti",
"50Ti", "50Cr", "53Cr", "54Cr", "54Fe", "57Fe", "58Fe",
"60Ni", "61Ni", "62Ni", "64Ni", "65Cu", "66Zn", "67Zn",
"68Zn", "70Zn", "76Se", "77Se", "78Se", "82Se", "84Sr",
"86Sr", "87Sr", "91Zr", "92Zr", "94Zr", "96Zr"), code = c("M",
"[17O]", "[18O]", "D", "[15N]", "[33S]", "[34S]", "[36S]",
"[37Cl]", "[81Br]", "[41K]", "[6Li]", "[10B]", "[21Ne]",
"[22Ne]", "[25Mg]", "[26Mg]", "[29Si]", "[30Si]", "[42Ca]",
"[43Ca]", "[44Ca]", "[48Ca]", "[46Ti]", "[47Ti]", "[49Ti]",
"[50Ti]", "[50Cr]", "[53Cr]", "[54Cr]", "[54Fe]", "[57Fe]",
"[58Fe]", "[60Ni]", "[61Ni]", "[62Ni]", "[64Ni]", "[65Cu]",
"[66Zn]", "[67Zn]", "[68Zn]", "[70Zn]", "[76Se]", "[77Se]",
"[78Se]", "[82Se]", "[84Sr]", "[86Sr]", "[87Sr]", "[91Zr]",
"[92Zr]", "[94Zr]", "[96Zr]"), stringsAsFactors = FALSE)
curiso <- isotopecode[which(isotopecode[, 1] %in% colnames(x)),]
x <- as.data.frame(x)
x$ID <- ""
for (i in seq_len(nrow(curiso))) {
col <- which(colnames(x) == curiso[i, 1])[1]
num <- x[, col]
tomodify <- which(num != 0)
x$ID[tomodify] <- paste0(x$ID[tomodify],
paste0(curiso[i,2], num[tomodify]))
}
x$deltam <- x[, 1] - as.numeric(unlist(x[1, 1]))
View(x)
isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 0.2)[[1]]
259.0155319 -259.0092120
good <- c()
for (i in seq_len(nrow(x))) {
if (i == nrow(x)) {
good <- c(good, i)
next
}
if (farenough[i]) {
good <- c(good, i)
} else {
if (x[i, 2] > x[i + 1, 2]) {
good <- c(good, i)
}
}
}
good <- unique(good)
good
farenough <- diff(x[, 1]) > limitfactor
good <- c()
for (i in seq_len(nrow(x))) {
if (i == nrow(x)) {
good <- c(good, i)
next
}
if (farenough[i]) {
good <- c(good, i)
} else {
if (x[i, 2] > x[i + 1, 2]) {
good <- c(good, i)
}
}
}
good <- unique(good)
good <- c()
for (i in seq_len(nrow(x))) {
if (i == nrow(x)) {
good <- c(good, i)
next
}
if (farenough[i]) {
good <- c(good, i)
} else {
if (x[i, 2] > x[i + 1, 2]) {
good <- c(good, i)
}
}
}
farenough <- diff(x[, 1]) > limitfactor
good <- c()
for (i in seq_len(nrow(x))) {
if (i == nrow(x)) {
good <- c(good, i)
next
}
if (farenough[i]) {
good <- c(good, i)
} else {
if (x[i, 2] > x[i + 1, 2]) {
print(i)
good <- c(good, i)
}
}
}
x[3,2]
x[4,2]
x <- isopattern(isotopes, "C9H8Cl2N5", charge = 1, threshold = 0.2)[[1]]
farenough <- diff(x[, 1]) > limitfactor
good <- c()
for (i in seq_len(nrow(x))) {
if (i == nrow(x)) {
good <- c(good, i)
next
}
if (farenough[i]) {
good <- c(good, i)
} else {
if (x[i, 2] > x[i + 1, 2]) {
print(i)
good <- c(good, i)
}
}
}
good <- unique(good)
x <- x[good, ]
curiso <- isotopecode[which(isotopecode[, 1] %in% colnames(x)),]
x <- as.data.frame(x)
x$ID <- ""
for (i in seq_len(nrow(curiso))) {
col <- which(colnames(x) == curiso[i, 1])[1]
num <- x[, col]
tomodify <- which(num != 0)
x$ID[tomodify] <- paste0(x$ID[tomodify],
paste0(curiso[i,2], num[tomodify]))
}
x$deltam <- x[, 1] - as.numeric(unlist(x[1, 1]))
x <- x[-1, ]
View(x)
x <- isopattern(isotopes, "C6H5ClN3", charge = 1, threshold = 0.2)[[1]]
limitfactor <- 2 * kTHR * x[1, 1]^(1/2)/resol_factor
farenough <- diff(x[, 1]) > limitfactor
good <- c()
for (i in seq_len(nrow(x))) {
if (i == nrow(x)) {
good <- c(good, i)
next
}
if (farenough[i]) {
good <- c(good, i)
} else {
if (x[i, 2] > x[i + 1, 2]) {
print(i)
good <- c(good, i)
}
}
}
good <- unique(good)
x <- x[good, ]
curiso <- isotopecode[which(isotopecode[, 1] %in% colnames(x)),]
x <- as.data.frame(x)
x$ID <- ""
for (i in seq_len(nrow(curiso))) {
col <- which(colnames(x) == curiso[i, 1])[1]
num <- x[, col]
tomodify <- which(num != 0)
x$ID[tomodify] <- paste0(x$ID[tomodify],
paste0(curiso[i,2], num[tomodify]))
}
x$deltam <- x[, 1] - as.numeric(unlist(x[1, 1]))
x <- x[-1, ]
View(x)
devtools::install()
devtools::build_manual()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
library(formatR)
tidy_app()
BiocCheck::BiocCheck()
tidy_app()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
BiocCheck::BiocCheck()
source('~/GitHub/RHermes/R/General_methods.R')
myHermes <- readRDS("D:/dadesperjordi.rds")
PL(myHermes, 1)
PL(myHermes, 2)
SOI(myHermes, 2)
View(myHermes)
SOI(myHermes, 1)
IL(myHermes, 1)
myHermes
PL(myHermes, 2)
k <- PL(myHermes, 2)
View(k)
k <- PL(myHermes, 2)[[1]]
k <- PL(myHermes, 2)@peaklist
View(k)
View(k)
View(k)
MS2Data(myHermes, 1)
k <- MS2Data(myHermes, 1)
View(k)
DB(myHermes)
DB(myHermes)
adlist(myHermes)
myHermes@metadata@ExpParam@adlist
library(RHermes)
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
knitr::opts_chunk$set(collapse = TRUE)
library(RHermes)
myHermes <- setExpParam(myHermes, params = ExpParam(ppm = 4, res = 120000,
ion = "+"))
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
knitr::opts_chunk$set(collapse = TRUE)
library(RHermes)
myHermes <- RHermesExp()
myHermes <- setExpParam(myHermes, params = ExpParam(ppm = 4, res = 120000,
ion = "+"))
myHermes <- setExpParam(myHermes, template = "orbi-pos")
myHermes <- setDB(myHermes, db = "hmdb") #Loads a small HMDB subset
#For instance, remove adducts of unused solvents
myHermes <- remAd(myHermes, c("M+DMSO+H", "M+IsoProp+H"))
myHermes #Shows a summary of all set parameters and object info
sessionInfo()
adlist
adlist(myHermes)
adlist(myHermes)
#For instance, remove adducts of unused solvents
myHermes <- remAd(myHermes, c("M+DMSO+H", "M+IsoProp+H"))
#And we will add the "M+2H" adduct
myHermes <- addAd(myHermes, "M+2H", 2*1.00727600, ch = 2, mult = 1, toadd = "H2")
library(RHermes)
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
knitr::opts_chunk$set(collapse = TRUE)
myHermes <- processMS1(myHermes,
system.file("./MS1TestData.mzML", package = "RHermes"))
system.file("./MS1TestData.mzML", package = "RHermes")
system.file("./ExtData/MS1TestData.mzML", package = "RHermes")
system.file("ExtData/MS1TestData.mzML", package = "RHermes")
View(myHermes)
RHermes::setRHermesCluster()
View(myHermes)
library(RHermes)
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
knitr::opts_chunk$set(collapse = TRUE)
Cluster(myHermes)
library(RHermes)
library(RHermes)
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
knitr::opts_chunk$set(collapse = TRUE)
Cluster(myHermes)
library(RHermes)
??Cluster
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
knitr::opts_chunk$set(collapse = TRUE)
myHermes <- processMS1(myHermes,
system.file("ExtData/MS1TestData.mzML",
package = "RHermes"))
